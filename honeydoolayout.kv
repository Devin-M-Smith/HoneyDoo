#:import Factory kivy.factory.Factory

<BackgroundColor@Widget>
    background_color: 1, 1, 1, 0
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<SpinnerDrops@SpinnerOption>
    background_color: (0, .4, .2, 1) if self.state == 'down' else (0, .4, .2, 1)
    background_normal: ''
    background_down: ''
    canvas.before:
        Color:
            rgba: .8, 1, .9, 1
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
    font_size: '30sp'
    color: .8, 1, .9, 1

<HoneyDooSpinner@Spinner+BackgroundColor>
    background_color: 0, .4, .2, .6
    background_normal: ''
    background_down: ''
    font_size: '30sp'
    bold: True
    option_cls: Factory.get("SpinnerDrops")
    color: .8, 1, .9, 1

<NoSaveContent@GridLayout+BackgroundColor>
    background_color: 0, .4, .2, 1

<LoadContent@GridLayout+BackgroundColor>
    background_color: 0, .4, .2, 1

<LoadTitle@Label+BackgroundColor>
    color: .4, 1, .7, 1
    font_size: '64sp'

<LoadByline@Label+BackgroundColor>
    color: .4, 1, .7, .2
    font_size: '24sp'

<PairSetting@GridLayout+BackgroundColor>
    color: 0, 0, 0, 1
    bold: True
    cols: 3
    rows: 1
    RegisterContent:
        font_size: '15sp'
        text: 'Paired With: '
        size_hint_x: 
    RegisterContent:
        font_size: '15sp'
        id: paired
        halign: 'left'
        text: 'NONE'
    MenuItem:
        size_hint_x: .6
        text: 'CHANGE'
        on_release:
            Factory.get('SettingsWindow').updatePaired(self)


<UIDSetting@GridLayout+BackgroundColor>
    color: 0, 0, 0, 1
    bold: True
    cols: 2
    rows: 1
    RegisterContent:
        font_size: '15sp'
        text: 'PARING CODE: '
        halign: 'right'
    RegisterContent:
        halign: 'left'
        font_size: '15sp'
        id: uid

<RefreshLabel@Label+BackgroundColor>
    background_color: 0, .4, .2, 1
    color: .4, 1, .7, 1

<MainDisplay@GridLayout+BackgroundColor>
    background_color: .4, 1, .7, 1

<Menu@GridLayout+BackgroundColor>
    background_color: 1, 1, 1, 1

<MenuItem@Button+BackgroundColor>
    text_size: self.size
	bold: True
	halign: 'center'
    valign: 'middle'
	color: .8, 1, .9, 1
	background_color: 0, 1, .52, 1

<TaskItem@GridLayout+BackgroundColor>
    color: .8, 1, .9, 1
    background_color: 0, 1, .52, 1
    cols: 1
    rows: 2
    GridLayout:
        cols: 3
        rows: 1
        RefreshLabel:
            halign: 'center'
            markup: True
            id: status
        GridLayout:
            size_hint_x: 2
            cols: 1
            RefreshLabel:
                bold: True
                id: task_name
            RefreshLabel:
                id: task_id
                size_hint_y: 0
                opacity: 0
        RefreshLabel:
            halign: 'center'
            markup: True
            id: priority
    TaskDropdown:
        id: dropdown
        markup: True
        halign: 'center'
        valign: 'top'

<TaskDropdown@Label+BackgroundColor>
    size_hint_y: 0
    height: 0
    color: 0, 0, 0, 1

<SubmitButton@Button+BackgroundColor>
    text_size: self.size
	bold: True
	halign: 'center'
    valign: 'middle'
	color: .8, 1, .9, 1
	background_color: 0, 1, .52, .9

<BackButton@Button+BackgroundColor>
    text_size: self.size
	bold: True
	halign: 'center'
    valign: 'middle'
	color: 1, 1, .9, 1
	background_color: 0, 1, .52, 1

<HeaderGrid@GridLayout+BackgroundColor>
    cols: 2

<Header@Label+BackgroundColor>
	background_color: .8, 1, .9, 1
    color: 0, 0, 0, 1
    bold: True

<Priority@Label+BackgroundColor>
	background_color: .8, 1, .9, 1
    color: 0, 0, 0, 1
    bold: True

<Content@Label+BackgroundColor>
	background_color: .4, 1, .7, 1

<NewTaskHead@Label+BackgroundColor>
    color: 0, .4, .2, 1
    bold: True
    height: '30sp'
	background_color: .4, 1, .7, 1

<NewTaskInput@TextInput>
    multiline: False
    halign: 'center'
    valign: 'middle'
    font_size: self.parent.height/11
    background_color: .8, 1, .9, 1

<RegisterContent@Label+BackgroundColor>
    color: 0, .4, .2, 1
    bold: True
    font_size: '32sp'
	background_color: .4, 1, .7, 1

<Input@TextInput>
    multiline: False
    halign: 'center'
    size_hint: .3, .4
    font_size: '22sp'
    background_color: .8, 1, .9, 1

<NoSave>
    name: 'nosave'
    BoxLayout:
        orientation: 'vertical'
        NoSaveContent:
            cols: 1
            rows: 3
            LoadTitle:
                text: 'HoneyDoo'
            NoSaveContent:
                cols: 3
                rows: 1
                size_hint_y: .2
                NoSaveContent:
                    size_hint_x: .3
                NoSaveContent:
                    halign: 'center'
                    cols: 2
                    rows: 1
                    size_hint_y: .2
                    SubmitButton:
                        background_normal: ''
                        color: 0, .4, .2, 1
                        text: 'Sign In'
                        on_release:
                            app.root.current = 'sign'
                            app.root.transition.direction = "right"
                    SubmitButton:
                        text: 'Register'
                        color: 0, 1, .52, .9
                        background_color: .4, 1, .7, 1
                        on_release:
                            app.root.current = 'register'
                            app.root.transition.direction = "left"
                NoSaveContent:
                    size_hint_x: .3
            LoadByline:
                text: 'Shanor-Smith'
                size_hint_y: .2

<LoadWindow>
    name: 'load'
    BoxLayout:
        orientation: 'vertical'
        LoadContent:
            cols: 1
            rows: 3
            LoadTitle:
                text: 'HoneyDoo'
            LoadByline:
                id: connect_status
                color: 1, 1, 1, 1
                size_hint_y: .2
            LoadByline:
                text: 'Shanor-Smith'
                size_hint_y: .2

<Refresh>
    name: 'refresh'
    on_enter:
        app.root.current = 'main'
        root.manager.transition.direction = "up"
    RefreshLabel:
        text: 'LOADING'

<RefreshSettings>
    name: 'refreshSettings'
    on_enter:
        app.root.current = 'customSettings'
        root.manager.transition.direction = "up"
    RefreshLabel:
        text: 'LOADING'

<MainWindow>
    name: 'main'
    BoxLayout:
        orientation: 'vertical'
        RegisterContent:
            size_hint: None, None
            height: '10sp'
        GridLayout:
            cols: 1
            rows: 1
            size_hint_y: .1
            padding_x: '5sp'
            HoneyDooSpinner:
                id: menu
                text: 'v MENU v'
                values: ['CREATE NEW TASK', 'COMPLETE TASK', 'SETTINGS']
                on_text:
                    app.root.current = 'addTask' if(self.text == 'CREATE NEW TASK') else root.menuSelect(self.text)
                    app.root.transition.direction = "down"
                    

        RegisterContent:
            size_hint: None, None
            height: '10sp'
        ScrollView:
            GridLayout:
                size_hint_y: None
                height: self.minimum_height
                cols: 1
                id: tasks
                spacing: '1sp'
        BackButton:
            text: 'Full Task List'
            size_hint_y: None
            height: '60sp'
            on_release:
                app.root.current = 'tasklist'
                root.manager.transition.direction = 'left'


<TaskList>
    name: 'tasklist'
    BoxLayout:
        orientation: 'vertical'
        RegisterContent:
            id: topLabel
            size_hint_y: .2
        ScrollView:
            GridLayout:
                size_hint_y: None
                height: self.minimum_height
                cols: 1
                id: tasks
                spacing: '1sp'
        BackButton:
            text: 'Go Back'
            size_hint_y: None
            height: '60sp'
            on_release:
                app.root.current = 'main'
                root.manager.transition.direction = 'right'

<NewTask>
    name: 'addTask'
    on_pre_enter:
        self.ids.assigned.text = 'SELECT ASSIGNEE'
        self.ids.priority.text = 'SELECT PRIORITY'
        self.ids.task_name.text = ''
        self.ids.description.text = ''
    BoxLayout:
        orientation: 'vertical'
        padding: '4sp', '4sp'
        NewTaskHead:
            color: 0, 0, 0, 1
            font_size: '40sp'
            bold: True
            text: 'CREATE NEW TASK'
        MainDisplay:
            cols: 1
            rows: 10
            spacing: 0, '4sp'
            size_hint_y: 4
            HoneyDooSpinner:
                id: assigned
            NewTaskInput:
                id: task_name
                hint_text: 'TASK NAME'
                size_hint_y: 1.1
            NewTaskInput:
                id: description
                hint_text: '\nDESCRIPTION'
                multiline: True
                size_hint_y: 4
            HoneyDooSpinner:
                id: priority
                values: ['LOW', 'NORMAL', 'HIGH', 'MAJOR']
        SubmitButton:
            size_hint_y: .8
            text: "SUBMIT"
            on_release:
                app.root.current = root.submitTask(assigned.text, task_name.text, description.text, priority.text)
                root.manager.transition.direction = "up"
        BackButton:
            size_hint_y: .8
            text: "GO BACK"
            on_release:
                app.root.current = 'main'
                root.manager.transition.direction = "up"

<SettingsWindow>
    name: 'customSettings'
    BoxLayout:
        orientation: 'vertical'
        RegisterContent:
            height: '60sp'
            size_hint_y: None
            text: 'SETTINGS'
        ScrollView:
            GridLayout:
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                id: settingFields
                valign: 'center'
        BackButton:
            size_hint_y: None
            height: '60sp'
            text: 'EXIT'
            on_release:
                app.root.current = 'main'
                root.manager.transition.direction = "up"


<SignIn>
    name: 'sign'
    MainDisplay:
        cols: 1
        rows: 10
        padding: '5sp'
        Header:
            color: 0, 0, 0, 1
            text: "SIGN IN"
            font_size: '40sp'
            halign: "center"
            bold: True
        RegisterContent:
        RegisterContent:
            text: 'EMAIL'
        Input:
            id: Email
            hint_text: 'john@doe.com'
        RegisterContent:
            text: 'PASSWORD'
        Input:
            id: Password
            password: True
            hint_text: 'is!heReally/john_doe?'
        RegisterContent:
        MenuItem:
            text: "SIGN IN"
            on_release:
                app.root.current = root.signIn(Email.text, Password.text)
                root.manager.transition.direction = "up"
        BackButton:
            text: 'GO BACK'
            on_release:
                app.root.current = 'nosave'
                root.manager.transition.direction = "left"
                
<Register>
    name: 'register'
    MainDisplay:
        cols: 1
        rows: 11
        padding: '5sp'
        Header:
            color: 0, 0, 0, 1
            text: "REGISTER\nNEW ACCOUNT"
            font_size: '40sp'
            halign: "center"
            bold: True
        RegisterContent:
            text: 'EMAIL'
        Input:
            id: Email
        RegisterContent:
            text: 'FIRST NAME'
        Input:
            id: Name
        RegisterContent:
            text: 'PASSWORD'
        Input:
            id: Password
            password: True
        RegisterContent:
            text: 'CONFIRM PASSWORD'
        Input:
            id: Password2
            password: True
        RegisterContent:
            size_hint_y: 0.1
        MenuItem:
            text: "SUBMIT"
            on_release:
                root.submitUser(Email.text, Name.text, Password.text, Password2.text)

<DataError>
    Label:
        id: error
        text_size: self.width, None
        color: .8, 1, .9, 1
        size_hint: 1, 0.1
        padding_x: 5
        pos_hint: {"x": 0, "top": 0.8}

<TaskPopUp@Popup>
    GridLayout:
        cols: 2
        SubmitButton:
            background_normal: ''
            color: 0, .4, .2, 1
            text: 'Yes'
            on_release:
                root.updateCompleteTask()
                root.dismiss()
                app.root.current = 'refresh'
                app.root.transition.direction = "up"
        SubmitButton:
            text: 'No'
            color: 0, 1, .52, .9
            on_release:
                root.dismiss()

<EmailConfirm@Popup + BackgroundColor>
    auto_dismiss: False
    GridLayout:
        rows: 2
        cols: 1
        Label:
            color: .8, 1, .9, 1
            text: "Please Check Email For Confirmation Code"
            pos_hint: {"x": 0, "top": 0.3}
        GridLayout:
            cols: 2
            size_hint_y: .8
            Input:
                id: code
                size_hint_x: 2
            MenuItem:
                text: 'CONFIRM'
                on_release:
                    root.dismiss()
                    app.root.current = root.confirm(code.text)
                    app.root.transition.direction = "up"

<UpdatePaired@Popup + BackgroundColor>
    auto_dismiss: False
    GridLayout:
        rows: 2
        cols: 1
        Label:
            color: .8, 1, .9, 1
            text: "Please Enter New Paired Code\n(Enter 0 to un-pair)"
            pos_hint: {"x": 0, "top": 0.3}
        GridLayout:
            cols: 2
            size_hint_y: .8
            Input:
                id: code
                size_hint_x: 2
            MenuItem:
                text: 'CONFIRM'
                on_release:
                    root.dismiss()
                    app.root.current = root.paired(code.text)
                    app.root.transition.direction = "up"